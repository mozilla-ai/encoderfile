syntax = "proto3";

package encoderfile;

service EncoderFile {
    rpc Embedding(EmbeddingRequest) returns (EmbeddingResponse);
}

message EmbeddingRequest {
    string request_id = 1;
    repeated string inputs = 2;
    bool normalize = 3;
    bool return_tokens = 4;
    map<string, string> metadata = 5;
}

message EmbeddingResponse {
    string request_id = 1;
    // len(embeddings) == len(inputs)
    repeated EmbeddingSequence embeddings = 2;
    int32 dim = 3;
    map<string, string> metadata = 4;
}

message EmbeddingSequence {
    repeated EmbeddingVector embeddings = 1;
    repeated TokenInfo token_info = 2;
}

message TokenInfo {
  string token = 1;
  int32 token_id = 2;
  int32 start = 3;
  int32 end = 4;
}

message EmbeddingVector {
  repeated float values = 1;
}
